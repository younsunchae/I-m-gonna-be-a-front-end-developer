# 반정규화

- 데이터베이스의 성능 향상을 위하여, 데이터 중복을 허용하고 `조인을 줄이는` 데이터 베이스 성능 향상 방법
- 반정규화는 조회(select) 속도를 향상하지만, 데이터 모델의 유연성은 낮아진다.

## 반정규화가 필요할 때

- 정규화에 충실하여 종속서으 활용성을 향상되지만 수행 속도가 느려지는 경우
- 다량의 범위를 자주 처리해야하는 경우
- 특정 범위의 데이터만 자주 처리하는 경우
- 요약/집계 정보가 자주 요구되는 경우

## 반정규화 절차

- 대상 조사 및 검토 : 데이터 처리범위, 통계성 등을 확인하여 반정규화 대상을 조사

- 다른 방법 검토 : 반정규화를 수행하기 전에 다른 방법(클러스터링/뷰/ 인덱스 튜닝/응용 프로그램/파티션을 검토)을 검토한다.

- 반정규화 수행

> ### 클러스터링(Clustering)
>
> 클러스터링 인덱스라는 것은 인덱스 정보를 저장할 때 물리적으로 정렬해서 저장하는 방법으로 <br/>
> 조회 시에 인접 블록을 연속적으로 읽기 때문에 성능이 향상된다.

### 반정규화 기법

#### (1) 계산된 칼럼 추가

- 배치 프로그램으로 미리 계산하고 그 결과를 특정 칼럼에 추가한다.
- ex) 총판매액, 평균잔고

#### (2) 테이블 수직 분할

- 하나의 테이블을 2개 이상의 테이블로 분할한다.

#### (3) 테이블 수평 분할

- 하나의 테이블에 있는 값을 기준으로 테이블을 분할하는 방법

> ### 파티션(Partition) 기법
>
> 파티션을 사용하면 논리적으로는 하나의 테이블이지만 여러 개의 데이터 파일에 분산되어서 저장된다.

> Range Partition : 데이터의 값의 범위를 기준

> List Partition : 특정한 값을 지정하여

> Hash Partition : 해시 함수를 적용하여

> Composite Partition : Range + Hash

> ### 파티션 기법의 장점
>
> 데이터 조회 시에 액세스 범위가 줄어 들기 때문에 성능이 향상. <br/>
> 데이터가 분할되어 있기 때문에 I/O 성능이 향상. <br/>
> 각 파티션을 독립적으로 백업 및 복구가 가능

#### 4. 테이블 병합

- 1대1 관계의 테이블을 하나의 테이블로 병합해서 성능을 향상시킨다.
- 1대N 관계의 테이블을 병합하여 성능을 향상시킨다.
- 슈퍼 타입가 서브 타입 관계가 발생하면 테이블을 통합하여 성능을 향상 시킨다.

> ### super type과 sub type
>
> 부모와 자식과의 관계<br/>

> #### 슈퍼타입 및 서브 타입 변환방법
>
> ##### OneToOne Type : 슈퍼 타입과 서브 타입을 개별 테이블로 도출, 테이블의 수가 많아서 조인이 많이 발생하고 관리가 어려움
>
> ##### Plus Type : 슈퍼 타입과 서브 타입 테이블로 도출, 조인이 발생하고 관리가 어려움.
>
> ##### Signle Type : 슈퍼 타입과 서브 타입을 하나의 테이블로 도출, 조인 성능이 좋고 관리가 편리하지만 입출력 성능이 나쁨.
