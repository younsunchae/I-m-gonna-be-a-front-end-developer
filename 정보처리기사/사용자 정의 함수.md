# 사용자 정의 함수

프로시저와 유사하게 sql을 사용하여 일련의 작업을 연속적으로 처리하며, 종료 시 처리 결과를 단일값으로 반환하는 절차형 sql.

- 사용자 정의 함수는 데이터베이스에 저장되어, DML문의 호출에 의해 실행됨.
- 사용자 정의 함수는 예약어 RETURN을 통해 값을 반환하기 때문에 출력 파라미터가 없음.
- 사용자 정의 함수는 SELECT를 통한 조회만 할 수 있음.
- 사용자 정의 함수는 프로시저를 호출하여 사용할 수 없음.
- 사용자 정의함수는 내장함수추럼 DML문에서 반환 값을 활용하기 위한 용도로만 사용.

<br/>

# 사용자 정의 함수 구성

사용자 정의 함수의 구성은 프로시저와 유사하다. 프로시저 구성에서 RETURN 문만 추가하면 된다.

```SQL
DECLARE(필수) : 사용자 정의 함수의 명칭, 변수, 인수, 데이터 타입을 정의하는 선언부
BEGIN (필수)
    CONTROL
    SQL
    EXCEPTION
    RETURN(필수)
END (필수)
```

- DECLARE : 사용자 정의 함수의 명칭, 변수, 인수, 데이터 타입을 정의하는 선언부
- BEGIN : 사용자 정의 함수의 시작을 의미
- CONTROL : 조건문또는 반복문이 삽입되어 순차적으로 처리
- SQL : SELECT문이 삽입되어 데이터 조회 작업을 수행
- EXCEPTION : BEGIN ~ END 안의 구문 실행 시 예외가 발생하면 이를 처리하는 방법을 정의
- RETURN : 호출 프로그램에 반환할 값이나 변수를 정의
- END : 사용자 정의 함수의 종료를 의미

# 사용자 정의 함수 생성

```sql
CREATE [OR REPLACE] FUNCTION 사용자 정의 함수명 (파라미터)

[지역변수 선언]
BEGIN
    사용자 정의 함수 BODY;
    RETURN 반환값;
END;

```

- OR REPLACE : 선택적인 예약어, 이 예약어를 사용하면 동일한 사용자 정의 함수의 이름이 이미 존재하는 경우, 기존의 사용자 정의 함수를 대체할 수 있음
- 파라미터 : 사용자 정의 함수의 파라미터로는 다음과 같은 것들이 올 수 있음
- - IN : 호출 프로그램이 사용자 정의 함수에게 값을 전달할 때 지정
- - 매개변수명 : 호출 프로그램으로부터 전달받은 값을 저장할 변수의 이름을 지정
- - 자료형 : 변수의 자료형을 지정

- 사용자 정의함수 BODY : 사용자 정의 함수의 코드를 기록, BEGIN-END 사이에 적어도 하나의 SQL문이 있어야 함.

- RETURN 반환 값 : 반환할 값이나 반환할 값이 저장된 변수를 호출 프로그램으로 돌려줌.

# 사용자 정의 함수 실행

```sql
SELECT 사용자 정의 함수명 FROM 테이블명;
INSERT INTO 테이블명(속성명) VALUES (사용자 정의 함수명);
DELETE FROM 테이블명 WHERE 속성명 = 사용자 정의 함수명;
UPDATE 테이블명 SET 속성명 = 사용자 정의 함수명;
```

# 사용자 정의 함수 제거

```SQL
DROP FUNCTION 사용자 정의 함수명
```
